# CipherShare - General Copilot Instructions

## Project Overview

CipherShare is a secure secret sharing application with dual-layer encryption (AES-256-GCM + PBKDF2). The application enables users to request, submit, and retrieve sensitive information securely.

## Tech Stack

- **Frontend**: React 18.3, TypeScript 5.7, Vite 6.0, Tailwind CSS 4.1, React Router 7.1
- **Backend**: Node.js 24 LTS, Express 4.21, TypeScript 5.7
- **Database**: Redis 7 (in-memory with auto-expiration)
- **Testing**: Vitest 4.0 (frontend), Jest 29.7 (backend)

## Coding Standards

### TypeScript

- Always use TypeScript with strict mode enabled
- Avoid `any` types unless absolutely necessary
- Define clear interfaces and types for all data structures
- Use functional programming patterns where appropriate
- Prefer explicit type annotations for function parameters and return types

### Code Style

- Use functional components for React (no class components)
- Follow existing code patterns and conventions
- Use ES6+ features (async/await, arrow functions, destructuring)
- Keep functions small and focused on a single responsibility
- Use meaningful variable and function names

### Error Handling

- Always implement proper error handling with try-catch blocks
- Provide meaningful error messages to users
- Log errors appropriately for debugging
- Never expose sensitive information in error messages

## Security Best Practices

### Critical Security Requirements

- **Never log or expose sensitive data** (secrets, passwords, encryption keys)
- **Always validate and sanitize user inputs** on both frontend and backend
- **Use timing-safe comparisons** for password verification
- **Implement rate limiting** on all API endpoints
- **Never store passwords in plain text** - always use PBKDF2 hashing
- **Use AES-256-GCM** for encryption with proper IV generation
- **Ensure proper CORS configuration** for production environments

### Encryption Guidelines

- System-level encryption uses AES-256-GCM with a 32-byte hex key
- User passwords are hashed with PBKDF2 (100,000 iterations, SHA-256)
- Always generate new IVs for each encryption operation
- Never reuse salts or IVs

## Testing Requirements

### Test Coverage

- Add tests for all new features
- Maintain or improve existing code coverage
- Test both success and error cases
- Test edge cases and boundary conditions

### Test Structure

- Use descriptive test names that explain what is being tested
- Group related tests using `describe` blocks
- Use `beforeEach` for common setup
- Mock external dependencies (Redis, email services)
- Keep tests focused and independent

### Running Tests

```bash
npm test              # Run all tests (Vitest + Jest in parallel)
npm run test:frontend # Run frontend tests only (Vitest)
npm run test:unit     # Run backend tests only (Jest)
npm run test:watch    # Run in watch mode
```

## Development Workflow

### Local Setup

```bash
docker-compose up -d  # Start Redis
npm run dev           # Start dev servers (frontend + backend)
```

### Build and Deploy

```bash
npm run build         # Build both frontend and backend
npm start             # Start production server
```

## Commit Message Convention

Use conventional commit format:

```
feat: add new feature
fix: fix bug in component
docs: update documentation
style: format code
refactor: refactor code
test: add or update tests
chore: update dependencies
```

## Documentation

- Update relevant documentation when changing functionality
- Keep README.md, ARCHITECTURE.md, and CONTRIBUTING.md in sync
- Document all public APIs and complex functions
- Add JSDoc comments for exported functions

## Performance Considerations

- Minimize unnecessary re-renders in React components
- Use React.memo() for expensive components
- Implement proper caching strategies with Redis
- Optimize database queries and avoid N+1 queries
- Use appropriate TTL values for cached data

## Accessibility

- Ensure all interactive elements are keyboard accessible
- Use semantic HTML elements
- Provide appropriate ARIA labels where needed
- Maintain sufficient color contrast

## Dependencies

- Only add new dependencies when absolutely necessary
- Prefer well-maintained, widely-used packages
- Check for security vulnerabilities before adding dependencies
- Keep dependencies up to date

## Code Review Guidelines

- Make small, focused pull requests
- Write clear PR descriptions explaining the changes
- Respond to review comments promptly
- Ensure all tests pass before requesting review
- Follow the PR checklist in CONTRIBUTING.md
